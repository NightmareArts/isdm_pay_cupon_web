{% load static %}
<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Iniciar sesi√≥n ¬∑ ISDM Pay</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{% static 'css/auth.css' %}" rel="stylesheet">
</head>

<body>
    <div class="auth-bg">
        <div class="auth-card">
            <!-- Encabezado -->
            <div class="brand-mini">
                <img src="{% static 'img/isdm-logo.png' %}" alt="Instituto Superior Del Milagro">
            </div>
            <div class="auth-title">Instituto Superior<br>Del Milagro</div>
            <div class="auth-sub">NIVEL SUPERIOR TERCIARIO ‚Ä¢ N¬∞ 8207</div>

            <!-- Mensajes -->
            {% if messages %}
            <div class="mt-3">
                {% for m in messages %}
                <div class="alert alert-{{ m.tags|default:'info' }} py-2 mb-2">{{ m }}</div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Form -->
            <form method="post" class="mt-3" novalidate>
                {% csrf_token %}

                <div class="mb-3">
                    <label class="form-label">Correo electr√≥nico o usuario</label>
                    {{ form.username }}
                    {% if form.username.errors %}
                    <div class="text-error small mt-1">{{ form.username.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="mb-1">
                  <label class="form-label">Contrase√±a</label>

                  <div class="input-row">
                    {{ form.password }}  {# tiene class="form-control" por el StyledAuthenticationForm #}

                    <button
                      type="button"
                      class="eye-btn"
                      id="togglePassBtn"
                      aria-label="Mostrar contrase√±a"
                      aria-pressed="false"
                      title="Mostrar contrase√±a"
                      onclick="togglePass()">

                      <!-- ojo normal (oculto al inicio) -->
                      <svg id="icon-eye" width="22" height="22" viewBox="0 0 24 24" style="display:none" aria-hidden="true">
                        <path fill="currentColor" d="M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7Zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10Z"/>
                      </svg>

                      <!-- ojo tachado (visible al inicio) -->
                      <svg id="icon-eye-off" width="22" height="22" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill="currentColor" d="M2.1 3.5 3.5 2.1 21.9 20.5 20.5 21.9l-2.7-2.7C16.1 20.1 14.1 21 12 21 5 21 2 14 2 14s1.1-2.3 3.2-4.3L2.1 3.5ZM12 7c7 0 10 7 10 7s-.8 1.7-2.4 3.4l-3-3A5 5 0 0 0 12 7Zm-3 5a3 3 0 0 0 4.2 2.7l-3.9-3.9c-.2.35-.3.74-.3 1.2Z"/>
                      </svg>
                    </button>
                  </div>

                  {% if form.password.errors %}
                    <div class="text-error small mt-1">{{ form.password.errors.0 }}</div>
                  {% endif %}
                </div>

                {% if form.non_field_errors %}
                <div class="alert alert-danger py-2 mt-2">{{ form.non_field_errors.0 }}</div>
                {% endif %}

                <div class="inline-help mt-2 mb-3">
                    <a href="{% url 'password_reset' %}">¬øOlvid√≥ su contrase√±a?</a>
                </div>

                {% if next %}<input type="hidden" name="next" value="{{ next }}">{% endif %}

                <button class="btn btn-primary w-100">Acceder</button>

                <div class="divider-text mt-3">¬øNo tienes cuenta?</div>

                <a class="btn btn-outline-red w-100" href="{% url 'signup' %}">Registrarse</a>

                <div class="cookie-note">üç™ Aviso de Cookies</div>
            </form>
        </div>
    </div>

    <script>
      function togglePass(){
        const pass = document.getElementById("id_password");
        const btn  = document.getElementById("togglePassBtn");
        const eye  = document.getElementById("icon-eye");
        const off  = document.getElementById("icon-eye-off");
        if(!pass) return;

        // alternar tipo
        pass.type = (pass.type === "password") ? "text" : "password";

        // estado resultante
        const visible = (pass.type === "text");

        // iconos y atributos accesibles seg√∫n estado resultante
        eye.style.display = visible ? "inline" : "none";
        off.style.display = visible ? "none" : "inline";
        btn.setAttribute("aria-pressed", String(visible));
        btn.setAttribute("aria-label", visible ? "Ocultar contrase√±a" : "Mostrar contrase√±a");
        btn.setAttribute("title", visible ? "Ocultar contrase√±a" : "Mostrar contrase√±a");
      }
    </script>
</body>

</html>